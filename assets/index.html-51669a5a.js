import{_ as n,o as s,c as a,e as t}from"./app-647d7352.js";const p="/tracer/assets/架构.drawio-86cae67c.png",o="/tracer/assets/生命周期.drawio-a0283d4c.png",e={},c=t('<div class="custom-container tip"><p class="custom-container-title">TIP</p><p>插件开发之前必须要了解到tracer的项目架构以及核心hooks</p></div><h2 id="架构" tabindex="-1"><a class="header-anchor" href="#架构" aria-hidden="true">#</a> 架构</h2><p><img src="'+p+'" alt="Alt text"></p><ul><li>Node端中包含cli包，node(core)包，bundler包。</li><li>node包：来创建整个App实例。</li><li>Cli包中：访问App实例，初始化APP，写入临时文件。并且控制bundler包创建devServer或者build项目</li></ul><h2 id="生命周期与hooks" tabindex="-1"><a class="header-anchor" href="#生命周期与hooks" aria-hidden="true">#</a> 生命周期与hooks</h2><p><img src="'+o+`" alt="Alt text"></p><h2 id="开发插件" tabindex="-1"><a class="header-anchor" href="#开发插件" aria-hidden="true">#</a> 开发插件</h2><p>tracer 插件只支持composition API，这意味着插件默认是一个函数, 其接收App实例作为参数，</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> App <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@tracer/node&quot;</span>

<span class="token keyword">const</span> <span class="token function-variable function">pluginFunction</span> <span class="token operator">=</span> <span class="token punctuation">(</span>app <span class="token operator">:</span>App<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>那么如何为插件定义name等一系列options，可以使用defineOptions函数</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> App<span class="token punctuation">,</span> defineOptions <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@tracer/node&quot;</span>

<span class="token keyword">const</span> <span class="token function-variable function">pluginFunction</span> <span class="token operator">=</span> <span class="token punctuation">(</span>app <span class="token operator">:</span>App<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">defineOptions</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        name<span class="token operator">:</span> <span class="token string">&quot;tracer-plugin-xxx&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span> 
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>配合多个hook来实现完整的插件功能</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> App<span class="token punctuation">,</span> defineOptions<span class="token punctuation">,</span> DepNode<span class="token punctuation">,</span> ProjectOptions <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@tracer/node&quot;</span>

<span class="token keyword">const</span> <span class="token function-variable function">pluginFunction</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">defineOptions</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        name<span class="token operator">:</span> <span class="token string">&quot;tracer-plugin-xxx&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token function">onAnalyzing</span><span class="token punctuation">(</span><span class="token punctuation">(</span>depNode<span class="token operator">:</span> DepNode<span class="token punctuation">,</span> depth<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token function">onAnalyzed</span><span class="token punctuation">(</span><span class="token punctuation">(</span>project<span class="token operator">:</span> ProjectOptions<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token function">onInitialized</span><span class="token punctuation">(</span><span class="token punctuation">(</span>projects<span class="token operator">:</span> ProjectOptions<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token function">onTemped</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token function">onBuilt</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token function">onWatching</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,13),i=[c];function l(u,r){return s(),a("div",null,i)}const k=n(e,[["render",l],["__file","index.html.vue"]]);export{k as default};
